<article id="post-使用kubeadm搭建kubernetes1.15" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
  
  
    <h1 class="article-title" itemprop="name">
      使用kubeadm搭建kubernetes1.15
    </h1>
  


  
  
  
  
    
<div style="margin-top:10px;">
  <span class="post-time">
    <span class="post-meta-item-icon">
      <!-- fonts.scss -->
      <!-- 百度字体平台:http://fontstore.baidu.com/static/editor/index.html -->
      <i class="icon-statistics"></i>
      <span class="post-meta-item-text"> 字数统计:</span>
      <span class="post-count">2.3k字</span>
    </span>
  </span>

  <span class="post-time">
    &nbsp; | &nbsp;
    <span class="post-meta-item-icon">
      <i class="icon-book icon"></i>
      <span class="post-meta-item-text"> 阅读时长≈</span>
      <span class="post-count">12分</span>
    </span>
  </span>
</div>


  
  </header>
  
  <div class="article-entry" itemprop="articleBody">
    
    <h3 id="使用kubeadm方式安装kubernetes"><a href="#使用kubeadm方式安装kubernetes" class="headerlink" title="使用kubeadm方式安装kubernetes"></a>使用<code>kubeadm</code>方式安装<code>kubernetes</code></h3><a id="more"></a>
<p>[TOC]</p>
<h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><p>在所有节点执行，此环节所有的节点操作系统均匀<code>centos7.6</code></p>
<h4 id="1、配置hosts解析"><a href="#1、配置hosts解析" class="headerlink" title="1、配置hosts解析"></a>1、配置<code>hosts</code>解析</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> cat /etc/hosts</span></div><div class="line">10.122.17.206 k8s-node3</div><div class="line">10.122.17.205 k8s-node2</div><div class="line">10.122.17.204 k8s-node1</div><div class="line">10.122.17.200 k8s-master</div><div class="line"><span class="meta">#</span><span class="bash"> masker 主机到node免密</span></div></pre></td></tr></table></figure>
<h4 id="2、禁用防火墙"><a href="#2、禁用防火墙" class="headerlink" title="2、禁用防火墙"></a>2、禁用防火墙</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">systemctl stop firewalld</div><div class="line">systemctl disable firewalld</div></pre></td></tr></table></figure>
<h4 id="3、禁用SELINUX"><a href="#3、禁用SELINUX" class="headerlink" title="3、禁用SELINUX"></a>3、禁用<code>SELINUX</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> setenforce 0</span></div><div class="line"><span class="meta">#</span><span class="bash"> sed -i <span class="string">'s/SELINUX=enforcing/SELINUX=disabled/'</span> /etc/selinux/config</span></div><div class="line"><span class="meta">#</span><span class="bash"> cat /etc/selinux/config</span></div><div class="line">SELINUX=disabled</div></pre></td></tr></table></figure>
<h4 id="4、创建-etc-sysctl-d-k8s-conf-添加如下内容-并使修改生效"><a href="#4、创建-etc-sysctl-d-k8s-conf-添加如下内容-并使修改生效" class="headerlink" title="4、创建/etc/sysctl.d/k8s.conf,添加如下内容,并使修改生效"></a>4、创建<code>/etc/sysctl.d/k8s.conf</code>,添加如下内容,并使修改生效</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> cat /etc/sysctl.d/k8s.conf </span></div><div class="line">net.bridge.bridge-nf-call-ip6tables = 1</div><div class="line">net.bridge.bridge-nf-call-iptables = 1</div><div class="line">net.ipv4.ip_forward = 1</div><div class="line"><span class="meta">#</span><span class="bash"> modprobe br_netfilter</span></div><div class="line"><span class="meta">#</span><span class="bash"> sysctl -p /etc/sysctl.d/k8s.conf</span></div></pre></td></tr></table></figure>
<h4 id="5、安装ipvs"><a href="#5、安装ipvs" class="headerlink" title="5、安装ipvs"></a>5、安装ipvs</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># cat &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;EOF</div><div class="line">#!/bin/bash</div><div class="line">modprobe -- ip_vs</div><div class="line">modprobe -- ip_vs_rr</div><div class="line">modprobe -- ip_vs_wrr</div><div class="line">modprobe -- ip_vs_sh</div><div class="line">modprobe -- nf_conntrack_ipv4</div><div class="line">EOF</div><div class="line"># chmod 755 /etc/sysconfig/modules/ipvs.modules &amp;&amp; bash /etc/sysconfig/modules/ipvs.modules &amp;&amp; lsmod | grep -e ip_vs -e nf_conntrack_ipv4</div></pre></td></tr></table></figure>
<p>上面脚本创建了的<code>/etc/sysconfig/modules/ipvs.modules</code>文件，保证在节点重启后能自动加载所需模块。使用<code>lsmod | grep -e ip_vs -e nf_conntrack_ipv4</code>命令查看是否已经正确加载所需的内核模块。<br>接下来还需要确保各个节点上已经安装了 ipset 软件包<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> yum install ipset -y</span></div></pre></td></tr></table></figure></p>
<p>为了便于查看 <code>ipvs</code> 的代理规则，最好安装一下管理工具 <code>ipvsadm</code><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> yum -y install ipvsadm -y</span></div></pre></td></tr></table></figure></p>
<h4 id="6、安装时间同步服务"><a href="#6、安装时间同步服务" class="headerlink" title="6、安装时间同步服务"></a>6、安装时间同步服务</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> yum install chrony -y</span></div><div class="line"><span class="meta">#</span><span class="bash"> systemctl <span class="built_in">enable</span> chronyd</span></div><div class="line"><span class="meta">#</span><span class="bash"> systemctl start chronyd</span></div><div class="line"><span class="meta">#</span><span class="bash"> chronyc sources</span></div></pre></td></tr></table></figure>
<h4 id="7、关闭swap分区"><a href="#7、关闭swap分区" class="headerlink" title="7、关闭swap分区"></a>7、关闭swap分区</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> swapoff <span class="_">-a</span></span></div></pre></td></tr></table></figure>
<p>修改<code>/etc/fstab</code>文件，注释掉<code>SWAP</code>的自动挂载，使用<code>free -m</code>确认<code>swap</code>已经关闭。<code>swappiness</code>参数调整，修改<code>/etc/sysctl.d/k8s.conf</code>添加下面一行：</p>
<h4 id="8、安装docker-ce"><a href="#8、安装docker-ce" class="headerlink" title="8、安装docker-ce"></a>8、安装<code>docker-ce</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> yum install -y yum-utils device-mapper-persistent-data lvm2</span></div><div class="line"><span class="meta">#</span><span class="bash"> yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span></div><div class="line"><span class="meta">#</span><span class="bash"> yum makecache fast</span></div><div class="line"><span class="meta">#</span><span class="bash"> yum list docker-ce --showduplicates | sort -r</span></div><div class="line"><span class="meta">#</span><span class="bash"> 可以选择安装一个版本，比如我们这里安装最新版本</span></div><div class="line"><span class="meta">#</span><span class="bash"> yum install docker-ce-19.03.1-3.el7 -y</span></div></pre></td></tr></table></figure>
<h4 id="9、配置Docker镜像加速器"><a href="#9、配置Docker镜像加速器" class="headerlink" title="9、配置Docker镜像加速器"></a>9、配置<code>Docker</code>镜像加速器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">cat &lt;&lt;EOF &gt;/etc/docker/daemon.json</div><div class="line">&#123;</div><div class="line">  "exec-opts": ["native.cgroupdriver=systemd"],</div><div class="line">  "registry-mirrors" : [</div><div class="line">    "https://ot2k4d59.mirror.aliyuncs.com/"</div><div class="line">  ]</div><div class="line">&#125;</div><div class="line">EOF</div></pre></td></tr></table></figure>
<h4 id="10、启动Docker"><a href="#10、启动Docker" class="headerlink" title="10、启动Docker"></a>10、启动<code>Docker</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> systemctl daemon-reload</span></div><div class="line"><span class="meta">#</span><span class="bash"> systemctl restart docker</span></div><div class="line"><span class="meta">#</span><span class="bash"> systemctl <span class="built_in">enable</span> docker</span></div></pre></td></tr></table></figure>
<h4 id="11、安装kubeadm、kubelet、kubectl"><a href="#11、安装kubeadm、kubelet、kubectl" class="headerlink" title="11、安装kubeadm、kubelet、kubectl"></a>11、安装<code>kubeadm</code>、<code>kubelet</code>、<code>kubectl</code></h4><p>配置<code>yum</code>源<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</div><div class="line">[kubernetes]</div><div class="line">name=Kubernetes</div><div class="line">baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/</div><div class="line">enabled=1</div><div class="line">gpgcheck=1</div><div class="line">repo_gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</div><div class="line">EOF</div></pre></td></tr></table></figure></p>
<p>安装<code>kubeadm</code>、<code>kubelet</code>、<code>kubectl</code><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes -y</span></div><div class="line"><span class="meta">#</span><span class="bash"> kubeadm version</span></div><div class="line">kubeadm version: &amp;version.Info&#123;Major:"1", Minor:"15", GitVersion:"v1.15.3", GitCommit:"2d3c76f9091b6bec110a5e63777c332469e0cba2", GitTreeState:"clean", BuildDate:"2019-08-19T11:11:18Z", GoVersion:"go1.12.9", Compiler:"gc", Platform:"linux/amd64"&#125;</div></pre></td></tr></table></figure></p>
<p>将 <code>kubelet</code> 设置成开机启动<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> systemctl <span class="built_in">enable</span> kubelet.service</span></div></pre></td></tr></table></figure></p>
<p>到这里为止上面所有的操作都需要在所有节点执行配置</p>
<h3 id="初始化集群"><a href="#初始化集群" class="headerlink" title="初始化集群"></a>初始化集群</h3><h4 id="1、在master节点配置配置kubeadm初始文件"><a href="#1、在master节点配置配置kubeadm初始文件" class="headerlink" title="1、在master节点配置配置kubeadm初始文件"></a>1、在master节点配置配置kubeadm初始文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">  kubeadm config <span class="built_in">print</span> init-defaults &gt; kubeadm.yaml</span></div><div class="line"><span class="meta">#</span><span class="bash"> cat kubeadm.yaml </span></div><div class="line">apiVersion: kubeadm.k8s.io/v1beta2</div><div class="line">bootstrapTokens:</div><div class="line">- groups:</div><div class="line">  - system:bootstrappers:kubeadm:default-node-token</div><div class="line">  token: abcdef.0123456789abcdef</div><div class="line">  ttl: 24h0m0s</div><div class="line">  usages:</div><div class="line">  - signing</div><div class="line">  - authentication</div><div class="line">kind: InitConfiguration</div><div class="line">localAPIEndpoint:</div><div class="line">  advertiseAddress: 10.122.17.200   # apiserver 节点内网IP</div><div class="line">  bindPort: 6443</div><div class="line">nodeRegistration:</div><div class="line">  criSocket: /var/run/dockershim.sock</div><div class="line">  name: k8s-master</div><div class="line">  taints:</div><div class="line">  - effect: NoSchedule</div><div class="line">    key: node-role.kubernetes.io/master</div><div class="line">---</div><div class="line">apiServer:</div><div class="line">  timeoutForControlPlane: 4m0s</div><div class="line">apiVersion: kubeadm.k8s.io/v1beta2</div><div class="line">certificatesDir: /etc/kubernetes/pki</div><div class="line">clusterName: kubernetes</div><div class="line">controllerManager: &#123;&#125;</div><div class="line">dns:</div><div class="line">  type: CoreDNS</div><div class="line">etcd:</div><div class="line">  local:</div><div class="line">    dataDir: /var/lib/etcd</div><div class="line">imageRepository: registry.aliyuncs.com/google_containers    # 科学上网使用阿里registry源</div><div class="line">kind: ClusterConfiguration</div><div class="line">kubernetesVersion: v1.15.3    # k8s版本</div><div class="line">networking:</div><div class="line">  dnsDomain: cluster.local</div><div class="line">  podSubnet: 192.168.0.0/16   # 我们这里是准备安装 calico 网络插件的，需要将 networking.podSubnet 设置为192.168.0.0/16</div><div class="line">  serviceSubnet: 10.96.0.0/12</div><div class="line">scheduler: &#123;&#125;</div><div class="line">---</div><div class="line">apiVersion: kubeproxy.config.k8s.io/v1alpha1</div><div class="line">kind: KubeProxyConfiguration</div><div class="line">mode: ipvs       # kube-proxy 模式</div></pre></td></tr></table></figure>
<h4 id="2、初始化master配置文件"><a href="#2、初始化master配置文件" class="headerlink" title="2、初始化master配置文件"></a>2、初始化<code>master</code>配置文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubeadm init --config kubeadm.yaml</span></div><div class="line">Your Kubernetes control-plane has initialized successfully!</div><div class="line"></div><div class="line">To start using your cluster, you need to run the following as a regular user:</div><div class="line"></div><div class="line">  mkdir -p $HOME/.kube</div><div class="line">  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</div><div class="line">  sudo chown $(id -u):$(id -g) $HOME/.kube/config</div><div class="line"></div><div class="line">You should now deploy a pod network to the cluster.</div><div class="line">Run "kubectl apply -f [podnetwork].yaml" with one of the options listed at:</div><div class="line">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</div><div class="line"></div><div class="line">Then you can join any number of worker nodes by running the following on each as root:</div><div class="line"></div><div class="line">kubeadm join 10.122.17.200:6443 --token abcdef.0123456789abcdef \</div><div class="line">    --discovery-token-ca-cert-hash sha256:44a4ed41c1f69a23139b5d1e2bb6ec158d835257c6aab0a7607a122e77f51c04</div></pre></td></tr></table></figure>
<h4 id="3、拷贝-kubeconfig-文件"><a href="#3、拷贝-kubeconfig-文件" class="headerlink" title="3、拷贝 kubeconfig 文件"></a>3、拷贝 kubeconfig 文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> mkdir -p <span class="variable">$HOME</span>/.kube</span></div><div class="line"><span class="meta">#</span><span class="bash"> sudo cp -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span></div><div class="line"><span class="meta">#</span><span class="bash"> sudo chown $(id -u):$(id -g) <span class="variable">$HOME</span>/.kube/config</span></div></pre></td></tr></table></figure>
<h4 id="4、kubectl自动补全"><a href="#4、kubectl自动补全" class="headerlink" title="4、kubectl自动补全"></a>4、kubectl自动补全</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> yum install -y bash-completion</span></div><div class="line"><span class="meta">#</span><span class="bash"> locate bash_completion</span></div><div class="line">/etc/bash_completion.d</div><div class="line">/etc/bash_completion.d/git</div><div class="line">/etc/bash_completion.d/iprutils</div><div class="line">/etc/bash_completion.d/oscap</div><div class="line">/etc/bash_completion.d/redefine_filedir</div><div class="line">/etc/bash_completion.d/scl.bash</div><div class="line">/etc/bash_completion.d/yum-utils.bash</div><div class="line">/etc/profile.d/bash_completion.sh</div><div class="line">/root/naftis/vendor/github.com/spf13/cobra/bash_completions.go</div><div class="line">/usr/share/bash-completion/bash_completion</div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">source</span> /usr/share/bash-completion/bash_completion</span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">source</span> &lt;(kubectl completion bash)</span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">echo</span> <span class="string">'source /usr/share/bash-completion/bash_completion'</span> &gt;&gt; .bashrc </span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">echo</span> <span class="string">'source &lt;(kubectl completion bash)'</span> &gt;&gt;.bashrc</span></div></pre></td></tr></table></figure>
<h3 id="添加计算节点"><a href="#添加计算节点" class="headerlink" title="添加计算节点"></a>添加计算节点</h3><h4 id="1、使用kubeadm添加计算节点"><a href="#1、使用kubeadm添加计算节点" class="headerlink" title="1、使用kubeadm添加计算节点"></a>1、使用<code>kubeadm</code>添加计算节点</h4><p><code>node</code>节点记住初始化集群上面的配置和操作要提前做好，必须安装好<code>kubeadm</code>、<code>kubelet</code>，执行以下命名<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubeadm join 10.122.17.200:6443 --token abcdef.0123456789abcdef \</span></div><div class="line">    --discovery-token-ca-cert-hash sha256:44a4ed41c1f69a23139b5d1e2bb6ec158d835257c6aab0a7607a122e77f51c04</div></pre></td></tr></table></figure></p>
<p>如果忘记了上面的<code>join</code>命令可以在<code>master</code>节点使用命令<code>kubeadm token create --print-join-command</code>重新获取,如下。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubeadm token create --print-join-command</span></div><div class="line">kubeadm join 10.122.17.200:6443 --token dkb75n.dxkqjiv96eu7ky2s \</div><div class="line">    --discovery-token-ca-cert-hash sha256:44a4ed41c1f69a23139b5d1e2bb6ec158d835257c6aab0a7607a122e77f51c04</div></pre></td></tr></table></figure></p>
<h4 id="2、执行成功后可以在master节点运行kubectl-get-nodes命令"><a href="#2、执行成功后可以在master节点运行kubectl-get-nodes命令" class="headerlink" title="2、执行成功后可以在master节点运行kubectl get nodes命令"></a>2、执行成功后可以在<code>master</code>节点运行<code>kubectl get nodes</code>命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubectl get nodes</span></div><div class="line">NAME         STATUS      ROLES    AGE     VERSION</div><div class="line">k8s-master   NotReady    master   3m    v1.15.3</div><div class="line">k8s-node1    NotReady    &lt;none&gt;   48m   v1.15.3</div><div class="line">k8s-node2    NotReady    &lt;none&gt;   24m   v1.15.3</div><div class="line">k8s-node3    NotReady    &lt;none&gt;   13m   v1.15.3</div></pre></td></tr></table></figure>
<p>可以看到是<code>NotReady</code>状态，这是因为还没有安装网络插件，接下来安装网络插件</p>
<h3 id="安装calio网络组建"><a href="#安装calio网络组建" class="headerlink" title="安装calio网络组建"></a>安装<code>calio</code>网络组建</h3><p>以下命令在控制节点执行</p>
<h4 id="1、安装calio网络插件"><a href="#1、安装calio网络插件" class="headerlink" title="1、安装calio网络插件"></a>1、安装<code>calio</code>网络插件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">  wget https://docs.projectcalico.org/v3.8/manifests/calico.yaml</span></div><div class="line"><span class="meta">#</span><span class="bash">  如果节点是多网卡，可以在资源清单文件中指定内网网卡</span></div><div class="line"><span class="meta">#</span><span class="bash"> vi calico.yaml</span></div><div class="line">......</div><div class="line">spec:</div><div class="line">  containers:</div><div class="line">  - env:</div><div class="line">    - name: DATASTORE_TYPE</div><div class="line">      value: kubernetes</div><div class="line">    - name: IP_AUTODETECTION_METHOD  # DaemonSet中添加该环境变量</div><div class="line">      value: interface=eth0    # 指定内网网卡</div><div class="line">    - name: WAIT_FOR_DATASTORE</div><div class="line">      value: "true"</div><div class="line">......</div><div class="line"><span class="meta">#</span><span class="bash"> kubectl apply <span class="_">-f</span> calico.yaml  <span class="comment"># 安装calico网络插件</span></span></div></pre></td></tr></table></figure>
<p>等待一段时间可以查看下<code>pod</code>的状态</p>
<h4 id="2、查看pod状态"><a href="#2、查看pod状态" class="headerlink" title="2、查看pod状态"></a>2、查看<code>pod</code>状态</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubectl get pods -n kube-system</span></div><div class="line">NAME                                       READY   STATUS    RESTARTS   AGE</div><div class="line">calico-kube-controllers-65b8787765-hx9cr   1/1     Running   0          3h50m</div><div class="line">calico-node-2rlsz                          1/1     Running   0          3h18m</div><div class="line">calico-node-5vz46                          1/1     Running   0          3h50m</div><div class="line">calico-node-6szsd                          1/1     Running   0          3h50m</div><div class="line">calico-node-s5nmr                          1/1     Running   0          3h29m</div><div class="line">coredns-bccdc95cf-9jf8w                    1/1     Running   0          4h8m</div><div class="line">coredns-bccdc95cf-gk27l                    1/1     Running   0          4h8m</div><div class="line">etcd-k8s-master                            1/1     Running   0          4h7m</div><div class="line">kube-apiserver-k8s-master                  1/1     Running   0          4h7m</div><div class="line">kube-controller-manager-k8s-master         1/1     Running   0          4h7m</div><div class="line">kube-proxy-5jbft                           1/1     Running   0          3h29m</div><div class="line">kube-proxy-d9p8w                           1/1     Running   0          3h18m</div><div class="line">kube-proxy-h6n88                           1/1     Running   0          3h54m</div><div class="line">kube-proxy-mqgj7                           1/1     Running   0          4h8m</div><div class="line">kube-scheduler-k8s-master                  1/1     Running   0          4h7m</div></pre></td></tr></table></figure>
<p>网络插件运行成功了，node 状态也正常了：</p>
<h4 id="3、查看node状态"><a href="#3、查看node状态" class="headerlink" title="3、查看node状态"></a>3、查看<code>node</code>状态</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubectl get nodes</span></div><div class="line">NAME         STATUS   ROLES    AGE     VERSION</div><div class="line">k8s-master   Ready    master   4h10m   v1.15.3</div><div class="line">k8s-node1    Ready    &lt;none&gt;   3h55m   v1.15.3</div><div class="line">k8s-node2    Ready    &lt;none&gt;   3h31m   v1.15.3</div><div class="line">k8s-node3    Ready    &lt;none&gt;   3h20m   v1.15.3</div></pre></td></tr></table></figure>
<h4 id="4、安装calicoctl"><a href="#4、安装calicoctl" class="headerlink" title="4、安装calicoctl"></a>4、安装calicoctl</h4><p>将<code>calicoctl</code>安装为<code>Kubernetes pod</code><br>使用<code>Kubernetes API</code>数据存储区<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubectl apply <span class="_">-f</span> https://docs.projectcalico.org/v3.8/manifests/calicoctl.yaml</span></div></pre></td></tr></table></figure></p>
<p>然后，您可以使用kubectl运行命令，如下所示<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubectl <span class="built_in">exec</span> -ti -n kube-system calicoctl -- /calicoctl get profiles -o wide</span></div><div class="line">NAME                                                 LABELS   </div><div class="line">kns.default                                          map[]    </div><div class="line">kns.kube-node-lease                                  map[]    </div><div class="line">kns.kube-public                                      map[]    </div><div class="line">kns.kube-system                                      map[]    </div><div class="line">ksa.default.default                                  map[]    </div><div class="line">ksa.kube-node-lease.default                          map[]    </div><div class="line">ksa.kube-public.default                              map[]    </div><div class="line">ksa.kube-system.attachdetach-controller              map[]    </div><div class="line">ksa.kube-system.bootstrap-signer                     map[]    </div><div class="line">ksa.kube-system.calico-kube-controllers              map[]    </div><div class="line">ksa.kube-system.calico-node                          map[]    </div><div class="line">ksa.kube-system.calicoctl                            map[]    </div><div class="line">ksa.kube-system.certificate-controller               map[]    </div><div class="line">ksa.kube-system.clusterrole-aggregation-controller   map[]    </div><div class="line">ksa.kube-system.coredns                              map[]    </div><div class="line">ksa.kube-system.cronjob-controller                   map[]    </div><div class="line">ksa.kube-system.daemon-set-controller                map[]    </div><div class="line">ksa.kube-system.default                              map[]    </div><div class="line">ksa.kube-system.deployment-controller                map[]    </div><div class="line">ksa.kube-system.disruption-controller                map[]    </div><div class="line">ksa.kube-system.endpoint-controller                  map[]    </div><div class="line">ksa.kube-system.expand-controller                    map[]    </div><div class="line">ksa.kube-system.generic-garbage-collector            map[]    </div><div class="line">ksa.kube-system.horizontal-pod-autoscaler            map[]    </div><div class="line">ksa.kube-system.job-controller                       map[]    </div><div class="line">ksa.kube-system.kube-proxy                           map[]    </div><div class="line">ksa.kube-system.namespace-controller                 map[]    </div><div class="line">ksa.kube-system.node-controller                      map[]    </div><div class="line">ksa.kube-system.persistent-volume-binder             map[]    </div><div class="line">ksa.kube-system.pod-garbage-collector                map[]    </div><div class="line">ksa.kube-system.pv-protection-controller             map[]    </div><div class="line">ksa.kube-system.pvc-protection-controller            map[]    </div><div class="line">ksa.kube-system.replicaset-controller                map[]    </div><div class="line">ksa.kube-system.replication-controller               map[]    </div><div class="line">ksa.kube-system.resourcequota-controller             map[]    </div><div class="line">ksa.kube-system.service-account-controller           map[]    </div><div class="line">ksa.kube-system.service-controller                   map[]    </div><div class="line">ksa.kube-system.statefulset-controller               map[]    </div><div class="line">ksa.kube-system.token-cleaner                        map[]    </div><div class="line">ksa.kube-system.ttl-controller                       map[]</div></pre></td></tr></table></figure></p>
<h4 id="5、设置别名"><a href="#5、设置别名" class="headerlink" title="5、设置别名"></a>5、设置别名</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">alias</span> calicoctl=<span class="string">"kubectl exec -i -n kube-system calicoctl /calicoctl -- "</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">echo</span> <span class="string">'alias calicoctl="kubectl exec -i -n kube-system calicoctl /calicoctl -- "'</span> &gt;&gt; .bashrc </span></div><div class="line"><span class="meta">#</span><span class="bash"> tail -n 1 .bashrc </span></div><div class="line">alias calicoctl="kubectl exec -i -n kube-system calicoctl /calicoctl -- "</div></pre></td></tr></table></figure>
<h4 id="6、使命别名执行命令"><a href="#6、使命别名执行命令" class="headerlink" title="6、使命别名执行命令"></a>6、使命别名执行命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> calicoctl get nodes</span></div><div class="line">NAME         </div><div class="line">k8s-master   </div><div class="line">k8s-node1    </div><div class="line">k8s-node2    </div><div class="line">k8s-node3</div></pre></td></tr></table></figure>
<h4 id="7、测试coredns"><a href="#7、测试coredns" class="headerlink" title="7、测试coredns"></a>7、测试coredns</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubectl run curl --image=radial/busyboxplus:curl -it </span></div><div class="line">kubectl run --generator=deployment/apps.v1 is DEPRECATED and will be removed in a future version. Use kubectl run --generator=run-pod/v1 or kubectl create instead.</div><div class="line">If you don't see a command prompt, try pressing enter.</div><div class="line">[ root@curl-6bf6db5c4f-dqw9x:/ ]$ nslookup kubernetes.default</div><div class="line">Server:    10.96.0.10</div><div class="line">Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local</div><div class="line"></div><div class="line">Name:      kubernetes.default</div><div class="line">Address 1: 10.96.0.1 kubernetes.default.svc.cluster.local</div><div class="line">[ root@curl-6bf6db5c4f-dqw9x:/ ]$</div></pre></td></tr></table></figure>
<h3 id="安装Dashboard"><a href="#安装Dashboard" class="headerlink" title="安装Dashboard"></a>安装Dashboard</h3><h4 id="1、下载kubernetes-dashboard-yaml文件"><a href="#1、下载kubernetes-dashboard-yaml文件" class="headerlink" title="1、下载kubernetes-dashboard.yaml文件"></a>1、下载<code>kubernetes-dashboard.yaml</code>文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> wget https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml</span></div></pre></td></tr></table></figure>
<h4 id="2、科学上网"><a href="#2、科学上网" class="headerlink" title="2、科学上网"></a>2、科学上网</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> vim kubernetes-dashboard.yaml</span></div><div class="line"><span class="meta">#</span><span class="bash"> 修改镜像名称</span></div><div class="line">......</div><div class="line">containers:</div><div class="line">- args:</div><div class="line">  - --auto-generate-certificates</div><div class="line">  image: registry.aliyuncs.com/google_containers/kubernetes-dashboard-amd64:v1.10.1   # 修改成阿里源</div><div class="line">  imagePullPolicy: IfNotPresent</div><div class="line">......</div><div class="line"><span class="meta">#</span><span class="bash"> 修改Service为NodePort类型</span></div><div class="line">......</div><div class="line">selector:</div><div class="line">  k8s-app: kubernetes-dashboard</div><div class="line">type: NodePort</div><div class="line">......</div></pre></td></tr></table></figure>
<h4 id="3、安装Dashboard"><a href="#3、安装Dashboard" class="headerlink" title="3、安装Dashboard"></a>3、安装<code>Dashboard</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubectl apply <span class="_">-f</span> kubernetes-dashboard.yaml</span></div><div class="line"><span class="meta">#</span><span class="bash"> kubectl get pods -n kube-system <span class="_">-l</span> k8s-app=kubernetes-dashboard</span></div><div class="line">NAME                                    READY   STATUS    RESTARTS   AGE</div><div class="line">kubernetes-dashboard-5dc4c54b55-c7sv2   1/1     Running   0          62s</div><div class="line">[root@k8s-master ~]# kubectl get pods,svc -n kube-system -l k8s-app=kubernetes-dashboard</div><div class="line">NAME                                        READY   STATUS    RESTARTS   AGE</div><div class="line">pod/kubernetes-dashboard-5dc4c54b55-c7sv2   1/1     Running   0          81s</div><div class="line"></div><div class="line">NAME                           TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)         AGE</div><div class="line">service/kubernetes-dashboard   NodePort   10.107.132.165   &lt;none&gt;        443:30114/TCP   80s</div></pre></td></tr></table></figure>
<h4 id="4、创建一个具有全局所有权限的用户来登录Dashboard"><a href="#4、创建一个具有全局所有权限的用户来登录Dashboard" class="headerlink" title="4、创建一个具有全局所有权限的用户来登录Dashboard"></a>4、创建一个具有全局所有权限的用户来登录<code>Dashboard</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> vim rbac.yml</span></div><div class="line">apiVersion: v1</div><div class="line">kind: ServiceAccount</div><div class="line">metadata:</div><div class="line">  name: admin-user</div><div class="line">  namespace: kube-system</div><div class="line">---</div><div class="line">apiVersion: rbac.authorization.k8s.io/v1</div><div class="line">kind: ClusterRoleBinding</div><div class="line">metadata:</div><div class="line">  name: admin-user</div><div class="line">roleRef:</div><div class="line">  apiGroup: rbac.authorization.k8s.io</div><div class="line">  kind: ClusterRole</div><div class="line">  name: cluster-admin</div><div class="line">subjects:</div><div class="line">- kind: ServiceAccount</div><div class="line">  name: admin-user</div><div class="line">  namespace: kube-system</div></pre></td></tr></table></figure>
<p>直接创建<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubectl apply <span class="_">-f</span> rbac.yml</span></div><div class="line"><span class="meta">#</span><span class="bash"> kubectl get secret -n kube-system|grep admin</span></div><div class="line">admin-user-token-wpqck                           kubernetes.io/service-account-token   3      2m38s</div></pre></td></tr></table></figure></p>
<h4 id="6、获取登录token"><a href="#6、获取登录token" class="headerlink" title="6、获取登录token"></a>6、获取登录<code>token</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk <span class="string">'&#123;print $1&#125;'</span>)|grep token:</span></div><div class="line">token:      eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLXdwcWNrIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIwZmUzNTRiYS1mODkxLTQ0M2UtOWUxMy0wNjE3NWEzNWI5NzMiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06YWRtaW4tdXNlciJ9.Xqq3V8MmFp5ssCw4Hhzxy9YmdiVxMLsMSXnMaklOkVjHiX4B4kVGED2IDmwTh3wEi2VqYxjkRVm-b_JY2AmCfoaPMUtb4R9OZj414volWgAH1CX4VbFB0o1yr6aP3i8SKmQlQfIweEqYUWDGB5zv3ml1u0WjUGyVJeiXY0GxDAtiROelsKaK4gHGsUlIFZ8izW0xmuGDnT9hvCuztqbGsb78bFmQfAL2dKNB12rLOg01EwF0g88jvtfHiv80yX18ulP46ZK0MFx4YhTrLRjq09rAqCSnMGWPHtBSogKUQhpDkwCze61ByKlG6KM_DhFE7elQkBEj-jwvygDwvn7tMQ</div></pre></td></tr></table></figure>
<h4 id="7、使用Firefox浏览器登录Dashboard"><a href="#7、使用Firefox浏览器登录Dashboard" class="headerlink" title="7、使用Firefox浏览器登录Dashboard"></a>7、使用<code>Firefox</code>浏览器登录<code>Dashboard</code></h4><p><img src="https://ljw.howieli.cn/blog/2019-9-1/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20190830152421.png" alt=""></p>
<p><img src="https://ljw.howieli.cn/blog/2019-9-1/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20190830152716.png" alt=""></p>

    

    
    <div class="page-reward">
      <a href="javascript:void(0);" class="page-reward-btn tooltip-top" target="_self">
        <div class="tooltip tooltip-east">
          <span class="tooltip-item">
            赏
          </span>
          <span class="tooltip-content">
            <span class="tooltip-text">
              <span class="tooltip-inner">
                <p class="reward-p"><i class="icon icon-quo-left"></i>谢谢你请我吃糖果<i
                    class="icon icon-quo-right"></i></p>
                <div class="reward-box">
                  
                  <div class="reward-box-item">
                    <img class="reward-img" src="/img/alipay.jpg">
                    <span class="reward-type">支付宝</span>
                  </div>
                  
                  
                  <div class="reward-box-item">
                    <img class="reward-img" src="/img/weixin.png">
                    <span class="reward-type">微信</span>
                  </div>
                  
                </div>
              </span>
            </span>
          </span>
        </div>
      </a>
    </div>
    

    
    <div class="declare"> 
      <ul class="post-copyright">
        <li>
          <strong>本文作者：</strong>
          李家旺
        </li>
        <li>
          <strong>本文链接：</strong>
          <a href="https://www.lijiawang.org/posts/使用kubeadm搭建kubernetes1.15.html" title="使用kubeadm搭建kubernetes1.15" target="_blank">https://www.lijiawang.org/posts/使用kubeadm搭建kubernetes1.15.html</a>
        </li>
        <li>
          <strong>版权声明： </strong>
          本博客所有文章除特别声明外，均采用 <a href="https://www.apache.org/licenses/LICENSE-2.0.html" rel="external nofollow" target="_blank">Apache License 2.0</a> 许可协议。转载请注明出处！
        </li>
      </ul>
    </div>
    

  </div>
  <div class="article-info article-info-index">
    
    
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">使用kubeadm搭建kubernetes1.15</a>
        		</li>
      		
		</ul>
	</div>

    
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/kubernetes//" class="article-tag-list-link color1">kubernetes</a>
        		</li>
      		
		</ul>
	</div>


    

    
    
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <!-- <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a> -->
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
     <!-- <img src="//pan.baidu.com/share/qrcode?url=https://www.lijiawang.org/posts/使用kubeadm搭建kubernetes1.15.html" alt="微信分享二维码"> -->
    </div>
</div>

<div class="mask js-mask"></div>

    
    <div class="clearfix"></div>
  </div>
  </div>
</article>


<nav id="article-nav">
  
    <a href="/posts/在k8s上部署ingress-nginx并使用.html" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          在k8s上部署ingress-nginx并使用
        
      </div>
    </a>
  
  
    <a href="/posts/harbor搭建.html" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">harbor搭建</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>













